//import groovy.json.JsonSlurper

pipeline {
    agent any
    stages {
       stage('Read the variables of service and versions') {
          steps {
                script {
		def datas = readYaml file: 'service.yml'
		httpq1=datas."${ENVIRONMENT}".httpq
		webhook1=datas."${ENVIRONMENT}".webhook003
		apimgr1=datas."${ENVIRONMENT}".apimgr
                echo "Got  httpq ${httpq1} from ${ENVIRONMENT} environment"
                echo "Got  webhook as ${webhook1} from ${ENVIRONMENT} environment"
                echo "Got  apimgr as ${apimgr1} from ${ENVIRONMENT} environment"
                       }
                }
                                                                }
       stage('Execute based on Environment') {
          steps {
                script {
			if (ENVIRONMENT == 'prod') {
                        	echo "Executing on the $ENVIRONMENT branch. Values of httpq = ${httpq1}, webhook = ${webhook1} and apimgr = ${apimgr1}"
	                    } else if (ENVIRONMENT == 'dev1') {
                                echo "Executing on the $ENVIRONMENT branch. Values of httpq = ${httpq1}, webhook = ${webhook1} and apimgr = ${apimgr1}"
                            } else {
        	                echo 'No Matching environment found....... '
                	    	   }
                       }
                }
                                                                }



}
}
